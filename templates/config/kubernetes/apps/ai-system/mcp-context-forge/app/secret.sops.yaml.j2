#% if mcp_context_forge_enabled | default(false) %#
---
#| ============================================================================= #|
#| MCP CONTEXT FORGE SECRET                                                      #|
#| SOPS-encrypted secrets for MCP Context Forge                                  #|
#| ============================================================================= #|
apiVersion: v1
kind: Secret
metadata:
  name: mcp-context-forge-secret
  namespace: ai-system
type: Opaque
stringData:
  #| Database connection URL (psycopg2 driver) #|
  DATABASE_URL: "postgresql://#{ mcp_context_forge_db_user | default('mcpgateway') }#:#{ mcp_context_forge_db_password }#@mcp-context-forge-postgresql-rw.ai-system.svc.cluster.local:5432/#{ mcp_context_forge_db_name | default('mcpgateway') }#"

  #| Redis/Dragonfly connection URL #|
  REDIS_URL: "redis://mcpgateway:#{ dragonfly_mcpgateway_password | default(dragonfly_password) }#@dragonfly.cache.svc.cluster.local:6379/0"

  #| Platform admin password (email-based auth) #|
  PLATFORM_ADMIN_PASSWORD: "#{ mcp_context_forge_admin_password }#"

  #| Basic Auth credentials (HTTP Basic auth for admin UI and metrics) #|
  BASIC_AUTH_USER: "admin"
  BASIC_AUTH_PASSWORD: "#{ mcp_context_forge_admin_password }#"

  #| JWT secret key #|
  JWT_SECRET_KEY: "#{ mcp_context_forge_jwt_secret }#"

  #| Auth encryption secret #|
  AUTH_ENCRYPTION_SECRET: "#{ mcp_context_forge_auth_encryption_secret }#"

#% if mcp_context_forge_keycloak_enabled | default(false) %#
  #| Keycloak client secret #|
  KEYCLOAK_CLIENT_SECRET: "#{ mcp_context_forge_keycloak_client_secret }#"
#% endif %#
#% if mcp_context_forge_backup_enabled | default(false) and cnpg_barman_plugin_enabled | default(false) %#
---
#| ============================================================================= #|
#| BACKUP CREDENTIALS - RustFS Access for PostgreSQL Backups                     #|
#| Used by Barman Cloud Plugin ObjectStore for WAL archiving and base backups    #|
#| ============================================================================= #|
apiVersion: v1
kind: Secret
metadata:
  name: mcp-context-forge-backup-credentials
  namespace: ai-system
type: Opaque
stringData:
  ACCESS_KEY_ID: "#{ mcp_context_forge_s3_access_key }#"
  SECRET_ACCESS_KEY: "#{ mcp_context_forge_s3_secret_key }#"
#% endif %#
#% endif %#
