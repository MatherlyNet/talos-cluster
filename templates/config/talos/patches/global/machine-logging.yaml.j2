#% if loki_enabled | default(false) %#
#| Talos Logging - forward service logs to Vector via UDP #|
#| Vector receives service logs on port 6051 #|
#| NOTE: Kernel logging (port 6050) is configured via Image Factory schematic extraKernelArgs #|
#| NOTE: Uses localhost because Talos can't resolve K8s DNS (cluster.local) #|
#| Vector runs as DaemonSet with hostNetwork, so each node has local Vector #|
#| REF: https://docs.siderolabs.com/talos/v1.11/configure-your-talos-cluster/logging-and-telemetry/logging #|
machine:
  logging:
    #| Service logs (machined, kubelet, etcd, etc.) via UDP JSON lines #|
    destinations:
      - endpoint: "udp://127.0.0.1:6051"
        format: json_lines
#% endif %#
