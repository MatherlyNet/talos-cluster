---
apiVersion: k8s.keycloak.org/v2alpha1
kind: KeycloakRealmImport
metadata:
  name: matherlynet-realm
  namespace: identity
spec:
  keycloakCRName: keycloak
  realm:
    realm: matherlynet
    enabled: true
    displayName: Matherlynet Realm
    ssoSessionIdleTimeout: 1800
    ssoSessionMaxLifespan: 36000
    accessTokenLifespan: 300
    accessTokenLifespanForImplicitFlow: 900
    registrationAllowed: false
    resetPasswordAllowed: true
    rememberMe: true
    loginWithEmailAllowed: true
    duplicateEmailsAllowed: false
    bruteForceProtected: true
    permanentLockout: false
    maxFailureWaitSeconds: 900
    minimumQuickLoginWaitSeconds: 60
    waitIncrementSeconds: 60
    quickLoginCheckMilliSeconds: 1000
    maxDeltaTimeSeconds: 43200
    failureFactor: 5
    clients:
      - clientId: "envoy-gateway"
        name: "Envoy Gateway SSO"
        description: "OIDC client for Envoy Gateway SecurityPolicy - enables browser SSO across all protected applications"
        enabled: true
        publicClient: false
        clientAuthenticatorType: "client-secret"
        secret: "fm7BunhHfJ3tOlbRMrbpNPCRJHz+85qRlOvxVMH6aWY="
        standardFlowEnabled: true
        directAccessGrantsEnabled: false
        serviceAccountsEnabled: false
        implicitFlowEnabled: false
        protocol: "openid-connect"
        redirectUris:
          - "https://*.matherly.net/oauth2/callback"
        webOrigins:
          - "https://*.matherly.net"
        attributes:
          pkce.code.challenge.method: "S256"
          post.logout.redirect.uris: "https://*.matherly.net/*"
        defaultClientScopes:
          - "openid"
          - "profile"
          - "email"
        optionalClientScopes:
          - "address"
          - "phone"
          - "offline_access"
